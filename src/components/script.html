<script src="./js/scripts.js"></script>
<script>
  document.addEventListener('alpine:init', () => {
    Alpine.data('data', () => ({}));
  });

  document.addEventListener('DOMContentLoaded', () => {
    const customInput = document.getElementById('custom-input');
    const dateElement = document.getElementById('selected-date');
    const timeElement = document.getElementById('selected-time');
    const clearButton = document.getElementById('clear-button');
    const calendarContainer = document.getElementById('calendar-container');
    const calendarElement = document.getElementById('vanilla-calendar');
    const timeOptions = document.getElementById('time-options');
    const { Calendar } = window.VanillaCalendarPro;

    // Инициализация календаря
    const calendar = new Calendar(calendarElement, {
      selectedTheme: 'light',
      displayDateMin: '2025-01-01',
      displayDateMax: '2025-12-30',
      disableDates: ['2025-01-10:2025-01-13', '2025-01-22'],
      selectedYear: 2025,
      selectedMonth: 0,
      settings: {
        lang: 'en',
        iso8601: true,
        selection: {
          day: 'single',
        },
      },
      onClickDate(self) {
        const selectedDate = self.context.selectedDates; // Получаем выбранную дату
        updateDate(selectedDate); // Обновляем дату в кастомном инпуте
        showTimePicker(); // Показываем выбор времени
      },
    });

    // Показываем контейнер с календарём при клике на кастомный инпут
    customInput.addEventListener('click', (event) => {
      // Если клик по кнопке очистки, не показывать календарь
      if (event.target === clearButton) return;

      calendarContainer.style.display = 'flex'; // Показываем контейнер
      calendarContainer.style.top = `50px`;
      calendarContainer.style.left = `0px`;
    });

    // Скрываем контейнер при клике вне его
    document.addEventListener('click', (event) => {
      if (
        !calendarContainer.contains(event.target) && // Если клик вне календаря
        event.target !== customInput && // И не по кастомному инпуту
        event.target.parentElement !== customInput // И не по его дочерним элементам
      ) {
        calendarContainer.style.display = 'none'; // Скрываем контейнер
      }
    });

    // Обновляем дату
    function updateDate(date) {
      dateElement.textContent = date; // Устанавливаем выбранную дату
      dateElement.classList.remove('placeholder'); // Убираем класс placeholder
    }

    // Обновляем время
    function updateTime(time) {
      timeElement.textContent = time; // Устанавливаем выбранное время
      timeElement.classList.remove('placeholder'); // Убираем класс placeholder
    }

    // Показываем выбор времени
    function showTimePicker() {
      generateTimeSlots(); // Генерируем слоты времени
    }

    // Генерация временных слотов
    function generateTimeSlots() {
      timeOptions.innerHTML = ''; // Очищаем предыдущие слоты
      const times = [
        '09:00 am', '10:00 am', '11:00 am', '12:00 pm', '01:00 pm',
      ];

      times.forEach((time) => {
        const timeButton = document.createElement('button');
        timeButton.textContent = time;
        timeButton.classList.add('time-slot');
        timeButton.addEventListener('click', () => {
          updateTime(time); // Обновляем время в кастомном инпуте
          calendarContainer.style.display = 'none'; // Скрываем контейнер
        });
        timeOptions.appendChild(timeButton);
      });
    }

    // Очистка данных
    clearButton.addEventListener('click', (event) => {
      event.stopPropagation(); // Предотвращаем всплытие клика
      dateElement.innerHTML = `${'MM <span class="text-Green">/</span> DD <span class="text-Green">/</span> YY'}`;
      timeElement.textContent = ' 8:00 pm';
      dateElement.classList.add('placeholder');
      timeElement.classList.add('placeholder');
    });

    // Инициализация календаря
    calendar.init();
  });

</script>